<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" th:href="@{/css/xswiper.min.css}" />
		<link rel="stylesheet" th:href="@{/css/xinit.css}" />
		<link rel="stylesheet" th:href="@{/css/xmain.css}" />
		<script type="text/javascript" th:src="@{/js/jquery-1.7.2.js}" ></script>
		<script type="text/javascript" th:src="@{/js/swiper.min.js}" ></script>
		<script type="text/javascript" th:src="@{/js/jquery.cookie.js}" ></script>
	</head>
	<body>
		<div class="nyMain">
			<div class="nycontainer">
			<div class="head">
			<div class="clearfix">
				<a href="/" class="left logo">
					<img th:src="@{/ximages/logo.png}" />
				</a>
				<!-- <div class="left headsuos">
					<em></em>
					<input type="button" class="headsuosBtn" value="搜索" onClick="search();"/>
					<input type="text" class="headsuosInp" th:text="${query}" id="keywords"/>
				</div> -->
				<div class="left menu clearfix">
					<a href="/">平台首页</a>
					<a id="xituzhiku" th:href="@{/patent/agmount}">稀土智库</a>
					<a id="cailiaojisuan" th:href="@{/material/calculate}">材料计算</a>
					<a id="chanyejiance" th:href="@{/jiance/jiancelist}">产业监测</a>
					<a id="zhishifuwu" th:href="@{/zhishifuwu/zhishifuwu}">情报服务</a>
					<a th:href="@{/hezuo/jiaoliu}">合作交流</a>
					<a th:href="@{/guanyu/women}">关于我们</a>
					
				</div>
				<div class="right">
					<!--登录前-->
					<!--<div class="loginbefore">
						<a href="javascript:;" class="loginBtn">登录</a><span>/</span><a href="loginBtn">注册</a>
					</div>-->
					<!--登陆后-->
					<div class="loginAfter">
						<div class="loginAfterM">
							<a href="#" class="loginAfterTx">
								<img id="headImg" th:src="@{/ximages/jiazai.png}" />
							</a>
							<div class="loginAfterNo">
								
								<div class="loginAfterNoM">
									<em class="loginAfterNoMSj"></em>
									<p>
										<!-- <span class="loginName" th:text="${user.account}"></span> -->
										<span class="loginName" id="logoinName"></span>
										<span class="vip">
										</span>
									</p>
									<p id="backgroud">
										<!-- <a th:each="cookie :${#httpServletRequest.getCookies()}" th:if="${cookie.getName().equals('token')}"  th:href="@{/user/list(token=${cookie.getValue()},pageIndex=0,pageSize=10)}"> -->
										<a th:href="@{/user/list(pageIndex=0,pageSize=10)}">
											<img th:src="@{/ximages/houtai.png}" />
											进入管理后台
										</a>
									</p>
									<p>
										<a th:each="cookie :${#httpServletRequest.getCookies()}" th:if="${cookie.getName().equals('openId')}"  th:href="@{/zhishifuwu/shenqinglist(userid=${cookie.getValue()})}">
											<img th:src="@{/ximages/dingdan.png}" />
											我的申请
										</a>
									</p>
									<p>
										<a id="quit" href="/">
											<img th:src="@{/ximages/tuichu.png}" />
											退出
										</a>
									</p>

								</div>
							</div>
						</div>
					</div>
				
				</div>
			</div>
		</div>              
		<div class="yuansNr">
			<div class="nycontainer" th:object="${master}">
				<div class="yuansNrOne">
					<span th:text="*{name}"></span><span th:text="*{enName}" style="font-size: 20px"></span>
				</div>
				<div class="clearfix yuansNrTwo">
					<div class="left yuansNrTwoLf">
						<div class="yuansNrTwoLfT clearfix">
							<a href="javascript:void(0)" id="desca" onclick="sw('desc')" class="ahover">
								<span>元素描述</span>
							</a>
							<a href="javascript:void(0)" id="historya" onclick="sw('history')">
								<span>历史介绍</span>
							</a>
							<a href="javascript:void(0)" id="methoda" onclick="sw('method')">
								<span>制备方法</span>
							</a>
							<a href="javascript:void(0)" id="propa" onclick="sw('prop')">
								<span>元素性质</span>
							</a>
							<a href="javascript:void(0)" id="othera" onclick="sw('other')">
								<span>其他</span>
							</a>
						</div>
					    <div class="yuansNrTwoLfB">
					    	<div class="yuansNrTwoLfBM active" id="desc" th:text="*{description}">
					    	</div>
					    	<div class="yuansNrTwoLfBM" id="history" th:text="*{history}">
					    	</div>
					    	<div class="yuansNrTwoLfBM" id="method" th:text="*{method}">
					    	</div>
					    	<div class="yuansNrTwoLfBM" id="prop" th:text="*{prop}">
					    	</div>
					    	<div class="yuansNrTwoLfBM" id="other" >
					    	</div>
					    </div>
					</div>
				    <div class="right yuansNrTwoRt">
				    	<div class="yuansNrTwoRtTl">
				    		<img th:src="@{/ximages/fenzi.png}" />主要化合物
				    	</div>
				    	<div class="yuansNrTwoRtB">
				    		<!-- <div class="yuansNrTwoRtBM"> -->
				    		<div class="yuansNrTwoRtBM">
				    			<span><a th:each="slave : ${slaves}" th:text="${slave.name} + '  '" style="color:#4A90E2"  th:href="@{/yuansu/xiangqing(name=${slave.name})}"></a></span>
				    			
				    		</div>
				    	</div>
				    </div>
				</div>
			    <div class="yuansNrlb">
			    	<div class="yuansNrThreeT clearfix">
			    		<a href="javascript:void(0)" onclick="e2o('expert')" class="ahover" id="expert">
			    			<span>相关专家</span>
			    		</a>
			    		<a href="javascript:void(0)"  onclick="e2o('org')"id="org">
			    			<span>相关机构</span>
			    		</a>
			    	</div>
			    	<div class="yuansNrThreeB yuansNrLbB">
			    		<div class="yuansNrThreeBM active" id="expertblock">
			    			<div class="yslbM">
			    			<div class="ysLb ysLb1">
			    				<div class="swiper-container">
                    				<div class="swiper-wrapper" id="expertinfo">
	    							</div>
			    			    	
			    				</div>
			    				<div class="swiper-button-next" id="next" style="display:none"></div>
                                <div class="swiper-button-prev" id="prev" style="display:none"></div>
			    		    </div>
			    			</div>
			    			</div>
			    		
			    		
			    		
			    	    <div class="yuansNrThreeBM" id="orgblock">
			    			<div class="yslbM">
			    			<div class="ysLb ysLb2">
			    				<div class="swiper-container">
			    				
			    					<div class="swiper-wrapper" id="orginfo">
	    							</div>
	    						</div>
			    			    <div class="swiper-button-next" id="next1" style="display:none"></div>
                                <div class="swiper-button-prev" id="prev1" style="display:none"></div>
                                
			    			</div>
			    		    </div>
			    		</div>
			    	
			    </div>
			    <div class="yuansNrThree">
			    	<div class="yuansNrThreeT clearfix">
			    		<a href="javascript:void(0)" onclick="p2p('patent')" class="ahover" id="patent">
			    			<span>相关专利</span>
			    		</a>
			    		<a href="javascript:void(0)" onclick="p2p('paper')" id="paper">
			    			<span>相关论文</span>
			    		</a>
			    	</div>
			    	<div class="yuansNrThreeB">
			    		<div class="yuansNrThreeBM active" id="patentContent">
			    			<div class="xiangguan">
			    				<ul id="patentInfo">
			    					
			    				</ul>
			    				<div class="sqPage" id="patentsqPage">
					            	 
					            </div>
			    				
			    			</div>
			    		</div>
			    	    <div class="yuansNrThreeBM" id="paperContent">
			    			<div class="xiangguan">
			    				<ul id="paperInfo">
			    					
			    				</ul>
			    				<div class="sqPage" id="papersqPage">
					            	 
					            </div>
			    			</div>
			    		</div>
			    	</div>
			    </div>
			</div>
		</div>
		   
			</div>
			</div>
			 
		<div th:replace="footer :: myfooter"></div>
		
		<script type="text/javascript" th:src="@{/js/main.js}" ></script>
		<script type="text/javascript" th:src="@{/js/common.js}" ></script>
		<script type="text/javascript" th:inline="javascript">
		var name = [[${name}]];
		$(document).ready(function () {
		    if($.cookie("role")!=null && $.cookie("role")==="普通用户"){
				$("#backgroud").css('display','none'); 
			}
			$("#logoinName").html($.cookie("nickName"));
		    $("#headImg").attr("src", $.cookie("headImg"));
		    getExperts(0);
		    getPatent(0);
		    getPaper(0);
		    getOrg(0);
		});
		
		
		function sw(name){
			$("#desca").removeClass("ahover");
			$("#historya").removeClass("ahover");
			$("#methoda").removeClass("ahover");
			$("#propa").removeClass("ahover");
			$("#othera").removeClass("ahover");
			$("#desc").removeClass("active");
			$("#history").removeClass("active");
			$("#method").removeClass("active");
			$("#prop").removeClass("active");
			$("#other").removeClass("active");
			if(name=="desc") {
				$("#desca").addClass("ahover");
				$("#desc").addClass("active");
			}else if(name=="history") {
				$("#historya").addClass("ahover");
				$("#history").addClass("active");
			}else if(name=="method") {
				$("#methoda").addClass("ahover");
				$("#method").addClass("active");
			}else if(name=="prop") {
				$("#propa").addClass("ahover");
				$("#prop").addClass("active");
			}else if(name=="other") {
				$("#othera").addClass("ahover");
				$("#other").addClass("active");
			}
		}
		
		function p2p(type) {
			$("#patent").removeClass("ahover");
			$("#paper").removeClass("ahover");
			$("#patentContent").removeClass("active");
			$("#paperContent").removeClass("active");
			if(type=="patent") {
				$("#patent").addClass("ahover");
				$("#patentContent").addClass("active");
			}else {
				$("#paper").addClass("ahover");
				$("#paperContent").addClass("active");
			}
		}
		
		function e2o(type) {
			$("#expert").removeClass("ahover");
			$("#org").removeClass("ahover");
			$("#expertblock").removeClass("active");
			$("#orgblock").removeClass("active");
			if(type=="expert") {
				$("#expert").addClass("ahover");
				$("#expertblock").addClass("active");
			}else {
				$("#org").addClass("ahover");
				$("#orgblock").addClass("active");
			}
		}
		
		function getPatent(index) { 
			var param = {
					'name' : name,
					'pageIndex' : index
				};
				 $.ajax({
					url : "/yuansu/xiangqing/related/patents",
					data : JSON.stringify(param),
					dataType : 'json',
					type : 'post',
					contentType: "application/json; charset=utf-8",
					success : function(data) {
						let items = data.patentList;
						if(JSON.stringify(items) === '[]') {
							return;
						}
						$("#patentInfo").html('');
						$.each(items,function(index,value){
							let li = $('<li></li>');
							let div1 = $('<div class=\"xianguanTl\"></div>');
							let a1 = $('<a href=\"/patent/get?id=' + value.id + '\">'+ value.title + '</a>');
							div1.append(a1);
							let div2 = $('<div class=\"xianguanB\"></div>');
							let span1 = $('<span>专利权人：' + value.person+ '</span>');
							let span2 = $('<span>优先权年：' + value.piroryear+ '</span>');
							div2.append(span1);
							div2.append(span2);
							li.append(div1);
							li.append(div2);
							$("#patentInfo").append(li);
						});
						var totalPages = data.totalPages;
						var totalCount = data.totalCount;
						var pageIndex = data.pageIndex;
						if(totalCount > 0){
							var pagecontent = "<span>";
							pagecontent += "<span>共 "+totalCount+" 条专利信息</span>";
							
							if(pageIndex+1 != 1){
								var px = pageIndex-1;
								pagecontent += "<a href=\"javascript:getPatent(0)\"><首页</a>";
								pagecontent += "<a href=\"javascript:getPatent("+px+")\"><上一页</a>";
							}
							if(pageIndex+1 != totalPages){
								var px = pageIndex+1;
								var pt = totalPages-1;
								//pagecontent += "<a href=\"javascript:getPatent("+px+")\">下一页<em>></em></a>";
								//pagecontent += "<a href=\"javascript:getPatent("+pt+")\">尾页<em>></em></a>";
								if(pageIndex < 999){
									pagecontent += "<a href=\"javascript:getPatent("+px+")\">下一页<em>></em></a>";
								}
								if(totalPages < 1000){
									pagecontent += "<a href=\"javascript:getPatent("+pt+")\">尾页<em>></em></a>";
								}
								if(totalPages >= 1000){
									pagecontent += "<a href=\"javascript:getPatent("+999+")\">尾页<em>></em></a>";
								}
							}
							pagecontent+="</span>";
							$("#patentsqPage").html(pagecontent);
						}
						
						}
						
				}); 
		}
		
		function getPaper(index) { 
			var param = {
					'name' : name,
					'pageIndex' : index
				};
				 $.ajax({
					url : "/yuansu/xiangqing/related/papers",
					data : JSON.stringify(param),
					dataType : 'json',
					type : 'post',
					contentType: "application/json; charset=utf-8",
					success : function(data) {
						let items = data.paperList;
						if(JSON.stringify(items) === '[]') {
							return;
						}
						$("#paperInfo").html('');
			            $.each(items,function(index,value){
			              let li = $('<li></li>');
			              let div1 = $('<div class=\"xianguanTl\"></div>');
			              let a1 = $('<a href=\"/paper/get?id=' + value.id + '\">'+ value.title + '</a>');
			              div1.append(a1);
			              let div2 = $('<div class=\"xianguanB\"></div>');
			              let span1 = $('<span>出处：' + value.journal+ '</span>');
			              let span2 = $('<span>出版年：' + value.year+ '</span>');
			              div2.append(span1);
			              div2.append(span2);
			              li.append(div1);
			              li.append(div2);
			              $("#paperInfo").append(li);
			            });
						var totalPages = data.totalPages;
						var totalCount = data.totalCount;
						var pageIndex = data.pageIndex;
						if(totalCount > 0){
							var pagecontent = "<span>";
							pagecontent += "<span>共 "+totalCount+" 条论文信息</span>";
							
							if(pageIndex+1 != 1){
								var px = pageIndex-1;
								pagecontent += "<a href=\"javascript:getPaper(0)\"><首页</a>";
								pagecontent += "<a href=\"javascript:getPaper("+px+")\"><上一页</a>";
							}
							if(pageIndex+1 != totalPages){
								var px = pageIndex+1;
								var pt = totalPages-1;
								//pagecontent += "<a href=\"javascript:getPatent("+px+")\">下一页<em>></em></a>";
								//pagecontent += "<a href=\"javascript:getPatent("+pt+")\">尾页<em>></em></a>";
								if(pageIndex < 999){
									pagecontent += "<a href=\"javascript:getPaper("+px+")\">下一页<em>></em></a>";
								}
								if(totalPages < 1000){
									pagecontent += "<a href=\"javascript:getPaper("+pt+")\">尾页<em>></em></a>";
								}
								if(totalPages >= 1000){
									pagecontent += "<a href=\"javascript:getPaper("+999+")\">尾页<em>></em></a>";
								}
							}
							pagecontent+="</span>";
							$("#papersqPage").html(pagecontent);
						}
						
						}
						
				}); 
		}
		
		function getExperts(index) {
			var param = {
					'name' : name,
					'pageIndex' : index
				};
				 $.ajax({
					url : "/yuansu/xiangqing/related/experts",
					data : JSON.stringify(param),
					dataType : 'json',
					type : 'post',
					contentType: "application/json; charset=utf-8",
					success : function(data) {
						let items = data.expertList;
						if(JSON.stringify(items) === '[]') {
							return;
						}
						$("#expertinfo").html('');
			            $.each(items,function(index,value){
			              let div1 = $('<div class=\"swiper-slide\"></div>');
			              let div2 = $('<div class=\"ysPer\"></div>');
			              let a2 = $('<a href=\"/expert/get?front=0&id=' + value.id + '\"></a>');
			              let img = $('<img src=\"/images/rencai.png\" />');
			              if(value.frontend !=null && value.frontend != '' ){
			                img = $('<img src=\"/file/fileDownload?filename='+value.frontend+'\" />');
			              }
			              
			              let p1 = $('<p class=\"ysName\">' + value.name+ '</p>');
			              let p2 = $('<p>' + value.unit+ '</p>');
			              a2.append(img);
			              a2.append(p1);
			              a2.append(p2);
			              div2.append(a2);
			              div1.append(div2);
			              $("#expertinfo").append(div1);
			            });
			            
			            let div1 = $('<div class=\"swiper-slide\"></div>');
			              let div2 = $('<div class=\"ysPer\"></div>');
			              let a2 = $('<a href=\"/expert/list?front=0&q=' +name+ '\"></a>');
			              let img = $('<img src=\"/images/11.png\" />');
			              //let p1 = $('<p class=\"ysName\">' + '查看更多'+ '</p>');
			              let p2 = $('<p>' + '</p>');
			              a2.append(img);
			              //a2.append(p1);
			              a2.append(p2);
			              div2.append(a2);
			              div1.append(div2);
			              $("#expertinfo").append(div1);
			            
			            if(items.length > 5){
			              document.getElementById("next").style="display:block";
			              document.getElementById("prev").style="display:block";
			            }
			            var swiper = new Swiper('.ysLb1 .swiper-container', {
			              slidesPerView:5,
			              spaceBetween: 18,
			              navigation: {
			                nextEl: '.ysLb1 .swiper-button-next',
			                prevEl: '.ysLb1 .swiper-button-prev',
			              },
			            });
						
						}
						
				});
		}
		
		function getOrg(index) {
			var param = {
					'name' : name,
					'pageIndex' : index
				};
				 $.ajax({
					url : "/yuansu/xiangqing/related/orgs",
					data : JSON.stringify(param),
					dataType : 'json',
					type : 'post',
					contentType: "application/json; charset=utf-8",
					success : function(data) {
						let items = data.orgList;
						if(JSON.stringify(items) === '[]') {
							return;
						}
						$("#orginfo").html('');
			            $.each(items,function(index,value){
			              let div1 = $('<div class=\"swiper-slide\"></div>');
			              let div2 = $('<div class=\"ysPer\"></div>');
			              let a2 = $('<a href=\"/org/get?front=0&id=' + value.id + '\"></a>');
			              let img = $('<img src=\"/images/rencai.png\" height="100" width="100"/>');
			              if(value.frontend !=null && value.frontend != '' ){
			                img = $('<img src=\"/file/fileDownload?filename='+value.frontend+'\" height="100" width="100"/>');
			              }
			              
			              let p1 = $('<p class=\"ysName\">' + value.name+ '</p>');
			              /* let p2 = $('<p>' + value.duty+ '</p>'); */
			              a2.append(img);
			              a2.append(p1);
			              /* a2.append(p2); */
			              div2.append(a2);
			              div1.append(div2);
			              $("#orginfo").append(div1);
			            });
			            
			            let div1 = $('<div class=\"swiper-slide\"></div>');
			              let div2 = $('<div class=\"ysPer\"></div>');
			              let a2 = $('<a href=\"/org/list?front=0&q=' +name+ '\"></a>');
			              let img = $('<img src=\"/images/22.png\" height="100" width="100"/>');
			              //let p1 = $('<p class=\"ysName\">' + '查看更多'+ '</p>');
			              let p2 = $('<p>' + '</p>');
			              a2.append(img);
			             // a2.append(p1);
			              a2.append(p2);
			              div2.append(a2);
			              div1.append(div2);
			              $("#orginfo").append(div1);
			              
			            if(items.length > 5){
			              document.getElementById("next1").style="display:block";
			              document.getElementById("prev1").style="display:block";
			            }
			            var swiper = new Swiper('.ysLb2 .swiper-container', {
			              slidesPerView:5,
			              spaceBetween: 18,
			              navigation: {
			                nextEl: '.ysLb2 .swiper-button-next',
			                prevEl: '.ysLb2 .swiper-button-prev',
			              },
			            });
						
						}
						
				});
		}
		
		function search(){
			    	var uri = '';
					if($("#keywords").val() != "") {
				    	window.location.href="/patent/list?q=" + $("#keywords").val() + "&" + uri;
					}
				}
		</script>

		
	</body>
</html>
